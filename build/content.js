chrome.runtime.onMessage.addListener(e=>{e.action==="fetchRandomUserData"?g(e.countries):e.action==="saveFormData"?h():e.action==="fillForm"&&p()});function h(){const e=document.querySelectorAll("input, textarea, select"),r={};e.forEach(t=>{t.name&&(r[t.name]=t.value)}),chrome.storage.local.set({formData:r},()=>{alert("Form data saved!")})}function p(){chrome.storage.local.get("formData",e=>{const r=e.formData;if(r){for(const t in r){const o=document.querySelector(`[name="${t}"]`);if(o){o.value=r[t];const a=new Event("input",{bubbles:!0}),u=new Event("change",{bubbles:!0});o.dispatchEvent(a),o.dispatchEvent(u),o.focus(),o.blur()}}alert("Form filled with saved data!")}else alert("No form data saved. Please save the form data first.")})}async function g(e){try{const r=await fetch(`https://randomuser.me/api/?nat=${e.join(",")}`);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);chrome.runtime.sendMessage({action:"log",message:`countries: ${e}, response: ${r}, url: ${r.url}`});const t=await r.json();if(!t)throw new Error("No results found");i(t.results[0])}catch{alert("Error fetching random user data"),i(null)}}function i(e){document.querySelectorAll("input, textarea, select").forEach(t=>{const o=t.name.toLowerCase();let a="";if(e?a=v(o,e):a=w(o,t),t.tagName.toLowerCase()==="textarea")t.value=a;else if(t.tagName.toLowerCase()==="select"){const n=t;Array.from(n.options).some(f=>f.value===a)?n.value=a:n.options.length>0&&(n.value=n.options[1].value)}else if(t.tagName.toLowerCase()==="input"&&t.type==="number")chrome.runtime.sendMessage({action:"log",message:`element.type: ${t.type}, value: ${a}`}),t.value=Math.floor(Math.random()*100);else if(t.tagName.toLowerCase()==="input"&&t.type==="checkbox")t.checked=a;else if(t.tagName.toLowerCase()==="input"&&t.type==="date")t.value=new Date().toISOString().slice(0,10);else if(t.tagName.toLowerCase()==="input"&&t.type==="datetime-local")t.value=new Date().toISOString().slice(0,16);else if(t.tagName.toLowerCase()==="input"&&t.type==="month")t.value=new Date().toISOString().slice(0,7);else if(t.tagName.toLowerCase()==="input"&&t.type==="time")t.value=new Date().toISOString().slice(11,16);else if(t.tagName.toLowerCase()==="input"&&t.type==="week")t.value=new Date().toISOString().slice(0,10);else if(t.tagName.toLowerCase()==="input"&&t.type==="range")t.value=Math.floor(Math.random()*100);else if(t.tagName.toLowerCase()==="input"&&t.type==="radio")t.checked=!0;else{if(t.tagName.toLowerCase()==="input"&&t.type==="submit"||t.type==="reset")return;t.tagName.toLowerCase()==="input"&&t.type==="color"?t.value=`#${Math.floor(Math.random()*16777215).toString(16)}`:t.value=a}const u=new Event("input",{bubbles:!0}),d=new Event("change",{bubbles:!0});t.dispatchEvent(u),t.dispatchEvent(d),t.focus(),t.blur()})}function v(e,r){switch(!0){case e.includes("username"):return r.login.username;case(e.includes("first name")||e.includes("first")):return r.name.first;case(e.includes("middle name")||e.includes("middle")):return"A.";case(e.includes("last name")||e.includes("last")):return r.name.last;case(e.includes("full name")||e.includes("full")):return`${r.name.first} ${r.name.last}`;case(e.includes("gender")||e.includes("sex")):return r.gender;case e.includes("name"):return`${r.name.first} ${r.name.last}`;case e.includes("email"):return r.email;case(e.includes("phone")||e.includes("tel")):return r.phone;case e.includes("cell"):return r.cell;case e.includes("address"):return`${r.location.street.number} ${r.location.street.name}, ${r.location.city}, ${r.location.state}, ${r.location.country}`;case e.includes("city"):return r.location.city;case e.includes("state"):return r.location.state;case e.includes("country"):return r.location.country;case e.includes("postcode"):return r.location.postcode.toString();case(e.includes("dob")||e.includes("birthday")):return new Date(r.dob.date).toISOString().split("T")[0];default:return s(20)}}function w(e,r){switch(!0){case e.includes("username"):return m();case(e.includes("first name")||e.includes("first")):return s(5);case(e.includes("middle name")||e.includes("middle")):return"A.";case(e.includes("last name")||e.includes("last")):return s(7);case(e.includes("full name")||e.includes("full")):return`${s(5)} ${s(7)}`;case(e.includes("gender")||e.includes("sex")):return["male","female"][Math.floor(Math.random()*2)];case e.includes("name"):return`${s(5)} ${s(7)}`;case e.includes("email"):return l();case(e.includes("phone")||e.includes("tel")):return c();case e.includes("cell"):return c();case e.includes("address"):return`${Math.floor(Math.random()*1e4)} ${s(15)} St, ${s(5)}, ${s(7)}, ${s(10)}`;case e.includes("city"):return s(15);case e.includes("state"):return s(15);case e.includes("country"):return s(15);case e.includes("postcode"):return`${Math.floor(Math.random()*1e4)}`;case(e.includes("dob")||e.includes("birthday")):return`19${Math.floor(Math.random()*90)+10}-0${Math.floor(Math.random()*9)+1}-0${Math.floor(Math.random()*9)+1}`;default:return $(r.type)}}function $(e){switch(e){case"text":return s(15);case"email":return l();case"number":return Math.floor(Math.random()*100).toString();case"tel":return c();case"url":return`http://example.com/${s(15)}`;case"textarea":return s(20);default:return s(20)}}function s(e){return Math.random().toString(36).substring(2,e+2)}function l(){return`${s(8)}@example.com`}function c(){return`123-456-789${Math.floor(Math.random()*10)}`}function m(){return`user_${s(8)}`}
